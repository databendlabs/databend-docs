---
title: Databend Cloud 中的数据恢复
sidebar_label: 数据恢复
---

本主题解释了如何使用 Databend Cloud 恢复更改或删除的数据。

## 时间旅行：轻松访问过去的数据

通过 Databend 时间旅行，即使数据已被更改或删除，您也可以回顾并检索过去的数据。它非常适用于：

- **恢复已删除的数据：** 帮助您找回重要的东西，如不小心或故意删除的表、数据库。

- **复制和保存过去的数据：** 允许您复制并保存早期的重要数据。

- **查看过去的数据使用情况：** 使查看数据在某些时候是如何被使用或更改的变得更加容易。

### 时间旅行的主要用途

- **访问过去的数据：** 查看过去的数据，即使它已经被更改或删除。
- **恢复丢失的数据：** 恢复被删除的表和数据库。

### 时间旅行 SQL 扩展

- **时间旅行的 SQL 扩展：** 在 SELECT 语句和 CREATE 命令中使用特殊的 SQL 子句，如[`AT`](/sql/sql-commands/query-syntax/query-at)，以指定您想要访问的历史准确点。
- **恢复已删除的数据：** 对表、数据库使用`UNDROP`命令。

### 设置数据保留期

- **标准版：** 选择无保留（0 天）或默认的**1 天**。
- **企业版及更高版本：**
  - 对于临时数据：设置为 0 或默认的**1 天**。
  - 对于持久化数据：从 **0 到 90 天** 中选择任何期限。

:::info 注意
设置保留期为 0 天意味着该数据将不适用于时间旅行。
:::

### 调整数据保留时间

使用`DATA_RETENTION_TIME_IN_DAYS`设置更改数据保留时间，通常为 1 天。这决定了保留旧数据的时间长短。

## 故障安全：为您的数据提供额外保护

Databend Cloud 中的故障安全是一个额外的安全特性，与时间旅行不同。它旨在保护您的数据免受系统问题或安全事件的影响。

### 故障安全的工作原理

故障安全在时间旅行期结束后提供固定的 7 天恢复窗口。

故障安全包括：

- **元数据恢复：** 使用元服务中的版本控制来恢复已删除的表。
- **数据恢复：** 使用 AWS S3 的版本控制来保存已更改或删除的数据。

:::caution 注意
- 故障安全是 Databend Cloud 提供的一项紧急服务，不可由用户配置。
- 它应仅在其他恢复方法不起作用后使用。
- 不旨在用于时间旅行期之外的常规历史数据访问。
- 用于在出现大问题后恢复数据，您无法自行设置。
- 恢复时间可能从几小时到几天不等，具体取决于情况。
:::
